<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Module.exports和exports的区别 · 信鑫-King's Blog</title><meta name="description" content="Module.exports和exports的区别 - Kylin King"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://www.ycjcl.cc/atom.xml" title="信鑫-King's Blog"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/ycjcl868" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/ycjcl868" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Module.exports和exports的区别</h1><div class="post-info">Jul 8, 2018</div><div class="post-content"><blockquote>
<p>学习<code>Seajs</code>时，看到了<code>exports.doSomething</code>和<code>module.exports</code>，想对这两者的区别一探究竟。</p>
</blockquote>
<p><img src="http://7xi72v.com1.z0.glb.clouddn.com/17-2-10/97116137-file_1486708942813_1278d.png" alt=""></p>
<h4 id="一、官方解释"><a href="#一、官方解释" class="headerlink" title="一、官方解释"></a>一、官方解释</h4><p>因为<code>SeaJs</code>和<code>Nodejs</code>都是基于<code>CommonJS</code>,所以直接看的<code>Node</code>的官方文档解释</p>
<h5 id="Module-exports"><a href="#Module-exports" class="headerlink" title="Module.exports"></a>Module.exports</h5><blockquote>
<p>The <strong>module.exports</strong> object is created by the Module system. Sometimes this is not acceptable; many want their module to be an instance of some class. To do this, assign the desired export object to <strong>module.exports</strong>. Note that assigning the desired object to <strong>exports</strong> will simply rebind the local <strong>exports</strong> variable, which is probably not what you want to do.</p>
</blockquote>
<blockquote>
<p>译文：<strong>module.exports</strong>对象是由模块系统创建的。 有时这是难以接受的；许多人希望他们的模块成为某个类的实例。 为了实现这个，需要将期望导出的对象赋值给<strong>module.exports</strong>。 注意，将期望的对象赋值给<strong>exports</strong>会简单地重新绑定到本地<strong>exports</strong>变量上，这可能不是你想要的。</p>
</blockquote>
<h5 id="exports"><a href="#exports" class="headerlink" title="exports"></a>exports</h5><blockquote>
<p>The <strong>exports</strong> variable is available within a module’s file-level scope, and is assigned the value of <strong>module.exports</strong> before the module is evaluated. It allows a shortcut, so that <strong>module.exports.f = …</strong> can be written more succinctly as <strong>exports.f = ….</strong> However, be aware that like any variable, if a new value is assigned to <strong>exports</strong>, it is no longer bound to <strong>module.exports</strong>:</p>
</blockquote>
<blockquote>
<p>译文：<strong>exports</strong>变量是在模块的文件级别作用域内有效的，它在模块被执行前被赋于 <strong>module.exports</strong> 的值。它有一个快捷方式，以便 <strong>module.exports.f = …</strong> 可以被更简洁地写成<strong>exports.f = …</strong>。 注意，就像任何变量，如果一个新的值被赋值给<strong>exports</strong>，它就不再绑定到<strong>module.exports</strong>(其实是<strong>exports.属性</strong>会自动挂载到没有命名冲突的<strong>module.exports.属性</strong>)</p>
</blockquote>
<h5 id="require"><a href="#require" class="headerlink" title="require"></a>require</h5><p>从require导入方式去理解，关键有两个变量(全局变量<code>module.exports</code>，局部变量<code>exports</code>)、一个返回值(<code>module.exports</code>)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">require</span>(<span class="params">...</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> <span class="built_in">module</span> = &#123; <span class="attr">exports</span>: &#123;&#125; &#125;;</span><br><span class="line">  (<span class="function">(<span class="params"><span class="built_in">module</span>, exports</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 你的被引入代码 Start</span></span><br><span class="line">    <span class="comment">// var exports = module.exports = &#123;&#125;; (默认都有的)</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">some_func</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line">    exports = some_func;</span><br><span class="line">    <span class="comment">// 此时，exports不再挂载到module.exports，</span></span><br><span class="line">    <span class="comment">// export将导出&#123;&#125;默认对象</span></span><br><span class="line">    <span class="built_in">module</span>.exports = some_func;</span><br><span class="line">    <span class="comment">// 此时，这个模块将导出some_func对象，覆盖exports上的some_func</span></span><br><span class="line">     <span class="comment">// 你的被引入代码 End</span></span><br><span class="line">  &#125;)(<span class="built_in">module</span>, <span class="built_in">module</span>.exports);</span><br><span class="line"> <span class="comment">// 不管是exports还是module.exports，最后返回的还是module.exports</span></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">module</span>.exports;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="二、Demo事例"><a href="#二、Demo事例" class="headerlink" title="二、Demo事例"></a>二、Demo事例</h4><h5 id="事例一：1-js"><a href="#事例一：1-js" class="headerlink" title="事例一：1.js"></a>事例一：<code>1.js</code></h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(exports); <span class="comment">// &#123;&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">module</span>.exports);  <span class="comment">// &#123;&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(exports === <span class="built_in">module</span>.exports);	<span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(exports == <span class="built_in">module</span>.exports);		<span class="comment">// true</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> Module &#123;</span></span><br><span class="line"><span class="comment">  id: '.',</span></span><br><span class="line"><span class="comment">  exports: &#123;&#125;,</span></span><br><span class="line"><span class="comment">  parent: null,</span></span><br><span class="line"><span class="comment">  filename: '/1.js',</span></span><br><span class="line"><span class="comment">  loaded: false,</span></span><br><span class="line"><span class="comment">  children: [],</span></span><br><span class="line"><span class="comment">  paths:</span></span><br><span class="line"><span class="comment">   [</span></span><br><span class="line"><span class="comment">     '/node_modules' ]</span></span><br><span class="line"><span class="comment"> &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">module</span>);</span><br></pre></td></tr></table></figure>
<h6 id="从事例一中，可以看出来"><a href="#从事例一中，可以看出来" class="headerlink" title="从事例一中，可以看出来"></a>从事例一中，可以看出来</h6><ul>
<li>1.每个<code>js</code>文件一创建，都有一个<code>var exports = module.exports = {};</code>，使<code>exports</code>和<code>module.exports</code>都指向一个空对象。</li>
<li>2.<code>module</code>是全局内置对象，<code>exports</code>是被<code>var</code>创建的局部对象。</li>
<li>3.<code>module.exports</code>和<code>exports</code>所指向的内存地址相同</li>
</ul>
<h5 id="事例二：2-js、3-js"><a href="#事例二：2-js、3-js" class="headerlink" title="事例二：2.js、3.js"></a>事例二：<code>2.js</code>、<code>3.js</code></h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 2.js</span></span><br><span class="line">exports.id = <span class="string">'exports的id'</span>;</span><br><span class="line">exports.id2 = <span class="string">'exports的id2'</span>;</span><br><span class="line">exports.func = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'exports的函数'</span>);</span><br><span class="line">&#125;;</span><br><span class="line">exports.func2 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'exports的函数2'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">	id: <span class="string">'module.exports的id'</span>,</span><br><span class="line">	func:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="built_in">console</span>.log(<span class="string">'module.exports的函数'</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 3.js</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="built_in">require</span>(<span class="string">'./2.js'</span>);</span><br><span class="line"><span class="comment">// 当属性和函数在module.exports都有定义时：</span></span><br><span class="line"><span class="built_in">console</span>.log(a.id);  <span class="comment">// module.exports的id</span></span><br><span class="line"><span class="built_in">console</span>.log(a.func()); <span class="comment">// module.exports的函数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 当属性在module.exports没有定义，函数在module.exports有定义</span></span><br><span class="line"><span class="built_in">console</span>.log(a.id2);  <span class="comment">// undefined</span></span><br><span class="line"><span class="built_in">console</span>.log(a.func());  <span class="comment">// module.exports的函数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 当函数在module.exports没有定义，属性在module.exports有定义</span></span><br><span class="line"><span class="built_in">console</span>.log(a.id);		<span class="comment">// module.exports的id</span></span><br><span class="line"><span class="built_in">console</span>.log(a.func2());	<span class="comment">// 报错了 TypeError: a.func2 is not a function</span></span><br></pre></td></tr></table></figure>
<h6 id="由例二可以知道："><a href="#由例二可以知道：" class="headerlink" title="由例二可以知道："></a>由例二可以知道：</h6><ul>
<li>1.<code>module.exports</code>像是<code>exports</code>的大哥，当<code>module.exports</code>以<code>{}</code>整体导出时会覆盖<code>exports</code>的属性和方法，</li>
<li>2.注意，若只是将属性/方法挂载在<code>module.exports.</code>/<code>exports.</code>上时，<code>exports.id=1</code>和<code>module.exports.id=100</code>，<code>module.exports.id=function(){}</code>和<code>exports.id=function(){}</code>，最后id的值取决于<code>exports.id</code>和<code>module.exports.id</code>的顺序，谁在后，就是最后的值</li>
</ul>
<p><img src="http://7xi72v.com1.z0.glb.clouddn.com/17-2-11/3342799-file_1486777354466_11a75.png" alt=""></p>
<ul>
<li>3.若<code>exports</code>和<code>module.exports</code>同时赋值时，<code>exports</code>所使用的属性和方法必须出现在<code>module.exports</code>，若属性没有在<code>module.exports</code>中定义的话，出现<code>undefined</code>，若方法没有在<code>module.exports</code>中定义，会抛出<code>TypeError</code>错误。</li>
</ul>
<h5 id="例三-4-js、5-js"><a href="#例三-4-js、5-js" class="headerlink" title="例三 4.js、5.js"></a>例三 <code>4.js</code>、<code>5.js</code></h5><p><code>module.exports</code>的对象、<code>prototype</code>、<code>构造函数</code>使用</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 4.js</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="built_in">require</span>(<span class="string">'./5.js'</span>);</span><br><span class="line"><span class="comment">// 若传的是类，new一个对象</span></span><br><span class="line"><span class="keyword">var</span> person = <span class="keyword">new</span> a(<span class="string">'Kylin'</span>,<span class="number">20</span>);</span><br><span class="line"><span class="built_in">console</span>.log(person.speak()); <span class="comment">// my name is Kylin ,my age is 20</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 若不需要在构造函数时初始化参数，直接调用方法/属性</span></span><br><span class="line"><span class="comment">// a.speak();  // my name is kylin ,my age is 20</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 5.js</span></span><br><span class="line"><span class="comment">// Person类</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name,age</span>)</span>&#123;</span><br><span class="line">	<span class="keyword">this</span>.name = name;</span><br><span class="line">	<span class="keyword">this</span>.age = age;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 为类添加方法</span></span><br><span class="line">Person.prototype.speak = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'my name is '</span>+<span class="keyword">this</span>.name+<span class="string">' ,my age is '</span>+<span class="keyword">this</span>.age);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回类</span></span><br><span class="line"><span class="built_in">module</span>.exports = Person;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 若构造函数没有传入参数(name,age)，直接传入对象</span></span><br><span class="line"><span class="comment">// module.exports = new Person('kylin',20);</span></span><br></pre></td></tr></table></figure>
<h6 id="说了这么多，其实建议就是，如果只是单一属性或方法的话，就使用exports-属性-方法。要是导出多个属性或方法或使用对象构造方法，结合prototype等，就建议使用module-exports-。文章有很多地方描述的可能不是很准确，提到的点也不够全面，如果有不对的地方，还望斧正！"><a href="#说了这么多，其实建议就是，如果只是单一属性或方法的话，就使用exports-属性-方法。要是导出多个属性或方法或使用对象构造方法，结合prototype等，就建议使用module-exports-。文章有很多地方描述的可能不是很准确，提到的点也不够全面，如果有不对的地方，还望斧正！" class="headerlink" title="说了这么多，其实建议就是，如果只是单一属性或方法的话，就使用exports.属性/方法。要是导出多个属性或方法或使用对象构造方法，结合prototype等，就建议使用module.exports = {}。文章有很多地方描述的可能不是很准确，提到的点也不够全面，如果有不对的地方，还望斧正！"></a>说了这么多，其实建议就是，如果只是单一属性或方法的话，就使用<code>exports.属性/方法</code>。要是导出多个属性或方法或使用<code>对象构造方法</code>，结合<code>prototype</code>等，就建议使用<code>module.exports = {}</code>。文章有很多地方描述的可能不是很准确，提到的点也不够全面，如果有不对的地方，还望斧正！</h6><blockquote>
<p>参考资料：<a href="http://nodejs.cn/api/modules.html#modules_module_exports" target="_blank" rel="noopener">Nodejs官方文档(中文)</a>、<a href="http://www.hacksparrow.com/node-js-exports-vs-module-exports.html" target="_blank" rel="noopener">Node.js Module – exports vs module.exports</a>、<a href="https://www.sitepoint.com/understanding-module-exports-exports-node-js/" target="_blank" rel="noopener">Understanding module.exports and exports in Node.js</a>、<a href="https://cnodejs.org/topic/5231a630101e574521e45ef8" target="_blank" rel="noopener">exports 和 module.exports 的区别</a></p>
</blockquote>
</div></article></div></main><footer><div class="paginator"><a href="/2018/07/08/深入学习下AJAX/" class="prev">PREV</a><a href="/2018/07/08/算法练习(Java)/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2018 <a href="https://www.ycjcl.cc">Kylin King</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>